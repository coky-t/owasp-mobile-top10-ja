---

layout: col-sidebar
title: "M9: 安全でないデータストレージ (Insecure Data Storage)"
---

# 脅威エージェント

**アプリケーション依存**

モバイルアプリケーションでの安全でないデータストレージは、脆弱性を悪用して機密情報への認可されていないアクセスを獲得することを狙うさまざまな脅威エージェントを引き寄せる可能性があります。これらの脅威エージェントには、貴重なデータを抽出するためにモバイルアプリをターゲットにする熟練した敵対者、組織またはアプリ開発チーム内の特権を悪用する悪意のある内部関係者、サイバースパイ活動を行う国家支援のアクター、データ窃取や身代金を通じて金銭的利益を狙うサイバー犯罪者、単純な攻撃のために事前構築されたツールを利用するスクリプトキディ、個人情報を販売するために安全でないストレージを悪用しようとするデータブローカー、競争上の優位性を得ようとする競合他社や産業スパイ、イデオロギー的な動機を持つアクティビストやハクティビストなどが含まれます。

これらの脅威エージェントは脆弱な暗号化、不十分なデータ保護、安全でないデータストレージメカニズム、ユーザー認証情報の不適切な処理などの脆弱性を悪用します。モバイルアプリの開発者や組織にとって、堅牢な暗号化、安全なデータストレージプラクティス、もバイアルアプリケーションセキュリティのベストプラクティスの遵守などの強力なセキュリティ対策を実施し、安全でないデータストレージに関連するリスクを軽減することが極めて重要です。

# 攻撃手法

**悪用難易度 容易**

モバイルアプリケーションの安全でないデータストレージは脅威アクターが悪用できるさまざまな攻撃ベクトルに対して脆弱性をさらします。攻撃ベクトルには、物理的またはリモート手段によるデバイスのファイルシステムへの認可されていないアクセス、脆弱な暗号化やその欠如の悪用、データ送信の傍受、デバイスにインストールされているマルウェアや悪意のあるアプリの利用などが含まれます。さらに、ルート化や脱獄されたデバイスは攻撃者がセキュリティ対策を回避し、機密データへの直接アクセスを獲得する機会を提供します。他の攻撃ベクトルには、ユーザーを欺いてデータへのアクセスを提供したり、アプリケーションの動作を操作するソーシャルエンジニアリング技法があります。

全体として、モバイルアプリケーション上の安全でないデータストレージは、直接データ抽出から機密情報の傍受に至るまでの攻撃の道を開き、モバイルアプリ開発における堅牢な暗号化、安全な伝送プロトコル、徹底したセキュリティ対策が極めて重要で必要であることを強調しています。

# セキュリティ上の弱点

**普及度 普通**

**検出難易度 普通**

モバイルアプリケーションの安全でないデータストレージは、保存されている情報の機密性と完全性を脅かす可能性があるさまざまなセキュリティ上の弱点を含んでいます。これらの弱点には脆弱な暗号化や暗号化なしでの使用が含まれ、攻撃者が機密データに容易にアクセスして解読できるようになります。さらに、プレーンテキストファイルや保護されていないデータベースなど、デバイスのファイルシステム内の簡単にアクセスできる場所にデータを保存すると、認可されていない抽出や操作にさらされます。アクセス制御とユーザー認証メカニズムが不十分であると、問題はさらに複雑になり、認可されていない個人が機密データにアクセスできるようになります。

さらに、安全なデータ転送プロトコルがないため、モバイルアプリと外部サーバー間の通信中にデータが傍受されやすくなります。モバイルアプリケーションのデータストレージにおけるこれらのセキュリティ上の弱点を総合すると、データ侵害、認可されていないアクセス、データ改竄の機会を生み出し、これらのリスクを軽減するために堅牢な暗号化、安全なストレージプラクティス、厳格なアクセス制御が極めて重要で必要であることを強調しています。


# 技術的影響

**影響度 深刻**

モバイルアプリケーションの安全でないデータストレージは、アプリの全体的なセキュリティと機能性を損なう重大な技術的影響をもたらす可能性があります。このような影響には以下があります。

**データ侵害:** 安全でないデータストレージは機密情報を認可されていないアクセスやデータ侵害の危険にさらします。攻撃者は脆弱性を悪用して機密データを抽出や操作し、潜在的なプライバシー侵害や機密情報の損失につながる可能性があります。

**ユーザーアカウントの侵害:** 不適切なデータストレージプラクティスはユーザーアカウントの侵害につながる可能性があります。攻撃者は安全に保存されていないログイン認証情報や個人情報へのアクセスを獲得して、認可されていないアカウントアクセス、個人情報窃取、ユーザーに代わって認可されていないアクティビティにつながる可能性があります。

**データ改竄と完全性の問題:** 適切なデータ保護対策がなければ、攻撃者は保存されたデータを変更や改竄できます。これにより、データ完全性問題、不正確な情報、アプリのデータストアへの悪意のあるコンテンツの注入につながる可能性があります。

**アプリケーションリソースへの認可されていないアクセス:** 安全でないデータストレージは、攻撃者に重要なアプリケーションリソースへの認可されていないアクセスを獲得する能力を提供する可能性があります。これには、アプリ内に保存されている機密ファイル、設定ファイル、暗号鍵を含み、これらを悪用してアプリの機能を侵害したり、基盤となるシステムを悪用する可能性があります。

**評判と信頼への損害:** アプリが安全でないデータストレージを持つことが判明すると、アプリ開発者や組織の評判や信頼を大きく損なう可能性があります。ユーザーはアプリのセキュリティに対する信頼を失い、その結果、ユーザーの利用が減少し、法的および規制上の影響を受ける可能性があります。

**コンプライアンス違反:** 安全でないデータストレージは業界の規制やデータ保護標準への不遵守につながる可能性があります。アプリ開発者は、ユーザーデータを適切に保護して安全にデータストレージプラクティスを維持することができない場合には、罰則や法的措置の対象となる可能性があります。


# ビジネスへの影響

**影響度 深刻**

モバイルアプリケーションの安全でないデータストレージのビジネスへの影響は重大かつ広範囲に及ぶ可能性があります。主要なビジネスへの影響をいくつか示します。

**風評被害**: 安全でないデータストレージはデータ侵害やユーザーアカウントの侵害につながり、組織の評判や信頼に深刻な損害を与える可能性があります。データ侵害のニュースはすぐに広がり、悪評、顧客の不満、潜在的なビジネスの損失を引き起こす可能性があります。

**顧客信頼の喪失**: 安全でないデータストレージにより機密性の高い顧客データが侵害されると、顧客は組織の情報保護能力に対する信頼を失う可能性があります。この信頼の喪失は、顧客ロイヤルティの低下、顧客離れの増加、全体的な顧客満足度への悪影響につながる可能性があります。

**法的および規制上の影響**: 不適切なデータストレージプラクティスは業界の規制やデータ保護法の不遵守につながる可能性があります。組織は、ユーザーデータを適切な保護を怠ったため、罰金、罰則、訴訟などの法的影響を受ける可能性があります。また、コンプライアンス違反は顧客やビジネスパートナーから見た組織の評判や信頼を損なう可能性もあります。

**経済的影響**: データ侵害とその結果生じる影響は組織に重大な経済的影響を及ぼす可能性があります。これには、侵害の調査、影響を与える顧客への通知、個人情報盗難保護サービスの提供、潜在的な法的解決、ビジネス機会の損失などに関連するコストが含まれます。

**競争上の不利益**: 今日のような競争の激しい状況では、データ侵害を経験したり安全でないデータストレージの評判がある組織は競争上の不利な状況に直面する可能性があります。顧客はデータのセキュリティに対する懸念をますます高めており、機密情報の保護においてより優れた実績を持つ競合他社を選択するかもしれません。

# 「安全でないデータストレージ」の脆弱性があるか？

モバイルアプリケーションの安全でないデータストレージと意図しないデータ漏洩はいくつかの形で現れ、潜在的なプライバシー侵害や機密情報への認可されていないアクセスをにつながる可能性があります。このような問題のよくある兆候は以下の通りです。

**アクセス制御の欠如**: アプリケーション内の不十分なアクセス制御により、認可されていないユーザーや攻撃者がデバイスやアプリのデータベースに保存されている機密データへのアクセスを獲得できる可能性があります。

**不適切な暗号化**: 機密データを適切に暗号化しないと、攻撃者が保存場所へのアクセスを獲得した場合、意図しないデータ漏洩につながる可能性があります。暗号化しなければ、データは簡単に読み取られ、悪用される可能性があります。

**意図しないデータ開示**: モバイルアプリケーションはアプリケーションログ、エラーメッセージ、デバッグ機能を通じて、機密データを不注意に開示し、認可されていない個人が機密情報を閲覧や取得できる可能性があります。

**不十分なセッション管理**: 脆弱なセッション管理は意図しないデータ漏洩につながる可能性があります。セッショントークンや認証情報が適切に保護や管理されていないと、それらを傍受されたり操作され、機密データへの認可されていないアクセスを許す可能性があります。

**不十分な入力バリデーション**: 不適切な入力バリデーションとデータサニタイゼーションは意図しないデータ漏洩につながる可能性があります。攻撃者はこの弱点を悪用して、入力フィールドを操作し、悪意のあるスクリプトを注入したり、機密データを取得する可能性があります。

**クラウドストレージの設定ミス**: モバイルアプリケーションがデータストレージにクラウドストレージサービスを使用する際、その設定を管理ミスや設定ミスしていると、保存データへの意図しない開示や認可されていないアクセスにつながる可能性があります。

**サードパーティライブラリの脆弱性**: モバイルアプリケーションで使用される安全でないサードパーティライブラリには意図しないデータ漏洩につながる脆弱性があるかもしれません。攻撃者はこのような脆弱性を悪用し、機密情報への認可されていないアクセスを獲得する可能性があります。

**意図しないデータ共有**: アプリケーション内のデータ共有機能の不適切な処理は意図しないデータ漏洩につながる可能性があります。機密データが意図しない受信者と共有されたり、共有プロセスが適切に保護されていないと、プライバシー侵害につながる可能性があります。


# 「安全でないデータストレージ」を防ぐには？

モバイルアプリケーションの安全でないデータストレージを防ぎ、機密データを確実に保護するには、以下のセキュリティ対策を導入する必要があります。

**強力な暗号化の使用**: 堅牢な暗号化アルゴリズムとプラクティスを導入して、保存時と転送時の両方で機密データを保護します。業界標準の暗号化アルゴリズムを利用し、暗号鍵が安全に保管および管理されるように確保します。

**安全なデータ転送**: 安全な通信プロトコル (HTTPS, SSL/TLS など) を利用し、モバイルアプリケーションとバックエンドサーバー間の転送時のデータを保護します。機密データを安全でないチャネルで送信することは避けます。

**安全なストレージメカニズムの導入**: 機密データは認可されていないユーザーがアクセスできない安全なストレージの位置に保存します。Keychain (iOS) や Keystore (Android) など、モバイルオペレーティングシステムが提供するプラットフォーム固有の安全なストレージメカニズムを使用します。

**適切なアクセス制御の採用**: 強力なアクセス制御を導入し、機密データへの認可されていないアクセスを制限します。ユーザーを安全に認証し、ロールベースのアクセス制御を適用し、機密情報へのアクセスを付与する前にユーザーパーミッションをバリデートします。

**入力のバリデートとデータのサニタイズ**: 入力バリデーションとデータサニタイゼーション技法を実装して、インジェクション攻撃を防ぎ、有効かつ期待されるデータのみが保存されるように確保します。ユーザー入力をバリデートし、悪意のあるコードインジェクションや意図しないデータ漏洩のリスクを軽減します。

**安全なセッション管理の適用**: ランダムに生成されるセッショントークンの使用、適切なセッションタイムアウト、クライアント側とサーバー側のセッションデータの安全な保存など、安全なセッション管理技法を実装します。

**依存関係の定期的なアップデートとパッチ適用**: すべてのライブラリ、フレームワーク、サードパーティの依存関係には安全でないデータストレージにつながるセキュリティ脆弱性を含む可能性があるため、最新の状態に保ちます。各ベンダーが提供するセキュリティパッチやアップデートを定期的に適用します。

**情報入手**: モバイルアプリケーション環境における最新のセキュリティ脅威と脆弱性に関する常に入手します。セキュリティフォーラム、セキュリティ勧告、モバイルプラットフォームのアップデートを監視して、新たに発生したリスクをタイムリーに軽減できるようにします。

# 攻撃シナリオの例

モバイルアプリケーションの安全でないデータストレージの潜在的なインスタンスを示すシナリオ例をいくつか示します。

**プレーンテキストでのパスワード保存**: モバイルアプリケーションはユーザーパスワードをローカルデータベースやファイルにプレーンテキスト形式で保存するため、攻撃者がデバイスへの認可されていないアクセスを獲得した場合、これらの認証情報を簡単に取得して悪用できます。

**安全でないローカルストレージ**: モバイルアプリケーションは、個人を識別できる情報 (PII) などの機密ユーザーデータを、適切なアクセス制御や暗号化を利用せずにデバイス上にローカルに保存します。これにより、デバイスに物理的にアクセスできる人は誰でもデータを抽出して閲覧できます。

**安全でないデータキャッシュ**: モバイルアプリケーションは、ユーザー認証トークンやセッション情報などの機密データを、適切なセキュリティ対策を実装せずにキャッシュします。攻撃者がデバイスのキャッシュへのアクセスを獲得すると、これらの認証情報を取得してユーザーになりすますことができます。

**保護されていないログ記録**: モバイルアプリケーションは、ユーザーアクション、API レスポンス、エラーメッセージなどの機密データを、適切なセキュリティ制御なしでログ記録します。これにより、攻撃者がデバイスへのアクセスを獲得したり、ログファイルを傍受した場合、機密情報の意図しない開示につながる可能性があります。

**安全でないクラウドストレージ設定**: モバイルアプリケーションはクラウドストレージサービスを利用してユーザーデータを保存しますが、保存されている情報への認可されていないアクセスを許可しています。これにより機密データのデータ漏洩や認可されていない開示につながる可能性があります。

**一時ファイルの不適切な処理**: モバイルアプリケーションは一時ファイルを作成し、機密データを処理または保存しますが、その後これらのファイルを適切に処理および削除しません。これにより、機密情報を開示したままとなり、認可されていないアクセスにさらされます。

# 参考資料

- OWASP
  - [OWASP](https://www.owasp.org/)
- その他
  - [External References](http://cwe.mitre.org/)
